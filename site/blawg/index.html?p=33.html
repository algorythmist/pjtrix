<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<title>autossh and screen for remote login peace of mind | Dread Pirate PJ&#8217;s House of Hacks and Tricks</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="/blawg/wp-content/themes/twentyten/style.css" />
<link rel="pingback" href="http/blawgxmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="Dread Pirate PJ&#039;s House of Hacks and Tricks &raquo; Feed" href="feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Dread Pirate PJ&#039;s House of Hacks and Tricks &raquo; Comments Feed" href="comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Dread Pirate PJ&#039;s House of Hacks and Tricks &raquo; autossh and screen for remote login peace of mind Comments Feed" href="2007/01/07/autossh-and-screen-for-remote-login-peace-of-mind/feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.pjtrix.com\/blawg\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.29"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Gearing up for an exciting 2007' href='index.html%3Fp=32.html' />
<link rel='next' title='Slight change of plans' href='index.html%3Fp=34.html' />
<meta name="generator" content="WordPress 4.2.29" />
<link rel='canonical' href='index.html%3Fp=33.html' />
<link rel='shortlink' href='index.html%3Fp=33.html' />

<!-- Bad Behavior 2.2.19 run time: 4.272 ms -->
<script type="text/javascript">
<!--
function bb2_addLoadEvent(func) {
	var oldonload = window.onload;
	if (typeof window.onload != 'function') {
		window.onload = func;
	} else {
		window.onload = function() {
			oldonload();
			func();
		}
	}
}

bb2_addLoadEvent(function() {
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1618586253 24.55.127.190';
			document.forms[i].appendChild(myElement);
		}
	}
});
// --></script>
		</head>

<body class="single single-post postid-33 single-format-standard">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			<div id="branding" role="banner">
								<div id="site-title">
					<span>
						<a href="/blawg/index.html" title="Dread Pirate PJ&#8217;s House of Hacks and Tricks" rel="home">Dread Pirate PJ&#8217;s House of Hacks and Tricks</a>
					</span>
				</div>
				<div id="site-description"></div>

										<img src="wp-content/themes/twentyten/images/headers/path.jpg" width="940" height="198" alt="" />
								</div><!-- #branding -->

			<div id="access" role="navigation">
			  				<div class="skip-link screen-reader-text"><a href="index.html%3Fp=33.html#content" title="Skip to content">Skip to content</a></div>
								<div class="menu"><ul><li ><a href="/blawg/index.html">Home</a></li><li class="page_item page-item-2"><a href="index.html%3Fp=2.html">About</a></li><li class="page_item page-item-65"><a href="index.html%3Fp=65.html">My writing</a></li></ul></div>
			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">

			

				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="index.html%3Fp=32.html" rel="prev"><span class="meta-nav">&larr;</span> Gearing up for an exciting 2007</a></div>
					<div class="nav-next"><a href="index.html%3Fp=34.html" rel="next">Slight change of plans <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-above -->

				<div id="post-33" class="post-33 post type-post status-publish format-standard hentry category-hacks category-open-source category-ssh">
					<h1 class="entry-title">autossh and screen for remote login peace of mind</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted on</span> <a href="index.html%3Fp=33.html" title="11:47 am" rel="bookmark"><span class="entry-date">January 7, 2007</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="author/admin/index.html" title="View all posts by dreadpiratepj">dreadpiratepj</a></span>					</div><!-- .entry-meta -->

					<div class="entry-content">
						<p>Unix server administrators everywhere are probably too familiar with connection timeouts when administering remote servers. There you are, dutifully editing that configuration file, when suddenly your text editor no longer responds to your cursor keys. A dozen seconds later or so, SSH reports the connection has been lost. If you didn&#8217;t save your file recently, you probably mutter a curse, for you probably have to redo your work all over again.</p>
<p>There is nothing worse than having to administer a server through a bad connection. When you are disconnected, having to reconnect, login, and navigate to where you last were, can knock you out of the flow of what you were doing, severely affecting your productivity.</p>
<h3><cite>screen</cite> to the rescue</h3>
<p>Back in the time of the dinosaurs and dial-up, some GNU hackers, tired of the inconvenience just described, invented the <cite>screen</cite> application. <cite>screen</cite> creates a virtual console running on the server, which keeps the user logged in to the server, even when the network connection is lost. With <cite>screen</cite>, you will never lose your place while logged in remotely again, baring a reboot, shutdown, or power-loss to the server itself (alas, <cite>screen</cite> is not magic.)</p>
<p><cite>screen</cite> can do much more than this simple description so far hints at. You can learn more from the online manual (type <cite>man screen</cite> at the command-line.) But for this hack, the following is all you need to remember:</p>
<p>Type in <cite>screen -DR</cite> when you first connect to your server, and your login session will be preserved through network disconnections. If you get disconnected, login again, and type <cite>screen -DR</cite> to return to your session, just as you left it.</p>
<p>The <cite>screen</cite> trick is all well and good. But we like to do things thoroughly at pjtrix, and try to find a full solution to the problem. <img src="/blawg/wp-includes/images/smilies/simple-smile.png" alt=":-)" class="wp-smiley" style="height: 1em; max-height: 1em;" /> So on to <cite>autossh</cite> we go.</p>
<h3><i>autossh</i>: aim for the kill</h3>
<p>Keeping with the dinosaurs and dial-up theme, <cite>autossh</cite> is like an auto-redialer. It faithfully tries to reconnect you to your server again as soon as it detects the connection is gone. It does this by creating an SSH tunnel loop between your workstation and the remote server, and monitors it repeatedly for lost messages.</p>
<p>Using <cite>autossh</cite> is almost like using <cite>ssh</cite>: except for the connection monitoring specifics, autossh simply passes all command-line parameters to <cite>ssh</cite>, and after entering the command-line, all user interaction is done through the running <cite>ssh</cite> instance. To use <cite>autossh</cite> effectively with <cite>screen</cite>, type the following command to first connect to your remote server (use this command instead of <cite>ssh</cite>):</p>
<p><cite><br />
autossh -M monitoring-port -t username@server.domain.tld &#8220;screen -DR&#8221;<br />
</cite></p>
<p>For example:</p>
<p><cite><br />
autossh -M 20000 -t webmaster@pjtrix.com &#8220;screen -DR&#8221;<br />
</cite></p>
<p>With the above command, <cite>autossh</cite> creates an SSH tunnel loop with ports 20,000 and 20,001 for monitoring the connection; the -t parameter makes <cite>ssh</cite> create a pseudo-terminal when it connects to the server; <cite>ssh</cite> connects to the server pjtrix.com as user webmaster; and finally, <cite>ssh</cite> runs the command <cite>screen -DR</cite> remotely on the server immediately upon a successful connection and user authentication.</p>
<p>If for any reason the connection to the server drops, <cite>autossh</cite> detects this, and starts another <cite>ssh</cite> session, with the same commands. This effectively reconnects you to the server, logs you back in, and returns you to your <cite>screen</cite> session, right where you left off.</p>
<p>Used together, <cite>autossh</cite> and <cite>screen</cite> are real peace of mind savers for Unix system administrators. Couple this hack with an SSH authentication agent and SSH keys, and you don&#8217;t even have to remember your server password between reconnects.</p>
<p>Truly, there can never be greater Unix administration bliss than this.</p>
<p><!-- Technorati Tags Start --></p>
<p>Technorati Tags:<br />
<a href="http://technorati.com/tag/hacks" rel="tag">hacks</a>, <a href="http://technorati.com/tag/ssh" rel="tag">ssh</a>, <a href="http://technorati.com/tag/open.source" rel="tag">open.source</a>
</p>
<p><!-- Technorati Tags End --></p>
											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='../../1.gravatar.com/avatar/1d55b341360e6454fe63f913bddcdb0f%3Fs=60&amp;d=mm&amp;r=pg' srcset='../../1.gravatar.com/avatar/1d55b341360e6454fe63f913bddcdb0f%3Fs=120&amp;d=mm&amp;r=pgamp;r=pg 2x' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar -->
						<div id="author-description">
							<h2>About dreadpiratepj</h2>
							I have been goofing around with computers since May 1978, when I was about seven years old. For the past decade, I've even managed to have people pay me for this! Suckers! :-)							<div id="author-link">
								<a href="author/admin/index.html" rel="author">
									View all posts by dreadpiratepj <span class="meta-nav">&rarr;</span>								</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description -->
					</div><!-- #entry-author-info -->

					<div class="entry-utility">
						This entry was posted in <a href="category/computing/software-development/hacks/index.html" rel="category tag">hacks</a>, <a href="category/free-culture/open-source/index.html" rel="category tag">open.source</a>, <a href="category/computing/networks/ssh/index.html" rel="category tag">ssh</a>. Bookmark the <a href="index.html%3Fp=33.html" title="Permalink to autossh and screen for remote login peace of mind" rel="bookmark">permalink</a>.											</div><!-- .entry-utility -->
				</div><!-- #post-## -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="index.html%3Fp=32.html" rel="prev"><span class="meta-nav">&larr;</span> Gearing up for an exciting 2007</a></div>
					<div class="nav-next"><a href="index.html%3Fp=34.html" rel="next">Slight change of plans <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
			<div id="comments">


			<h3 id="comments-title">2 Responses to <em>autossh and screen for remote login peace of mind</em></h3>


			<ol class="commentlist">
					<li class="comment even thread-even depth-1" id="li-comment-127">
		<div id="comment-127">
			<div class="comment-author vcard">
				<img alt='' src='../../1.gravatar.com/avatar/74a7f7df364cef450f1892649ac6add4%3Fs=40&amp;d=mm&amp;r=pg' srcset='../../1.gravatar.com/avatar/74a7f7df364cef450f1892649ac6add4%3Fs=80&amp;d=mm&amp;r=pgamp;r=pg 2x' class='avatar avatar-40 photo' height='40' width='40' />				<cite class="fn"><a href='http://www.quietvoice.org' rel='external nofollow' class='url'>Ken Nelson</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="2007/01/07/autossh-and-screen-for-remote-login-peace-of-mind/comment-page-1/index.html#comment-127">
				January 7, 2007 at 1:03 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Very cool.  I&#8217;ve used screen a little before, but autossh is a new one for me.   One suggestion: when you feature things like these, it would be nice to have download links to the packages you mention. I know we can all use &#8220;The Google&#8221;, but one of a SysAdmin&#8217;s required attributes is laziness.  At least, for me. <img src="/blawg/wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<p>-k-</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-128">
		<div id="comment-128">
			<div class="comment-author vcard">
				<img alt='' src='../../1.gravatar.com/avatar/1d55b341360e6454fe63f913bddcdb0f%3Fs=40&amp;d=mm&amp;r=pg' srcset='../../1.gravatar.com/avatar/1d55b341360e6454fe63f913bddcdb0f%3Fs=80&amp;d=mm&amp;r=pgamp;r=pg 2x' class='avatar avatar-40 photo' height='40' width='40' />				<cite class="fn"><a href='../../pjtrix.com/index.html' rel='external nofollow' class='url'>dreadpiratepj</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="2007/01/07/autossh-and-screen-for-remote-login-peace-of-mind/comment-page-1/index.html#comment-128">
				January 7, 2007 at 2:11 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Ken,</p>
<p>Thanks for the suggestion! I will keep that in mind in the future.</p>
<p>I&#8217;m trying to keep hacks in 2007 as relevant, short and sweet as possible (as opposed to the previous SSH hack in 2006, which rambed quite a lot.) But including a few links at the end won&#8217;t hurt.</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
			</ol>


			<p class="nocomments">Comments are closed.</p>
	


</div><!-- #comments -->


			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
			<ul class="xoxo">


			<li id="search" class="widget-container widget_search">
				<form role="search" method="get" id="searchform" class="searchform" action="/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form>			</li>

			<li id="archives" class="widget-container">
				<h3 class="widget-title">Archives</h3>
				<ul>
						<li><a href='2014/08/index.html'>August 2014</a></li>
	<li><a href='2012/07/index.html'>July 2012</a></li>
	<li><a href='2009/07/index.html'>July 2009</a></li>
	<li><a href='2009/06/index.html'>June 2009</a></li>
	<li><a href='2008/11/index.html'>November 2008</a></li>
	<li><a href='2008/10/index.html'>October 2008</a></li>
	<li><a href='2008/08/index.html'>August 2008</a></li>
	<li><a href='2008/05/index.html'>May 2008</a></li>
	<li><a href='2008/04/index.html'>April 2008</a></li>
	<li><a href='2008/03/index.html'>March 2008</a></li>
	<li><a href='2008/02/index.html'>February 2008</a></li>
	<li><a href='2008/01/index.html'>January 2008</a></li>
	<li><a href='2007/05/index.html'>May 2007</a></li>
	<li><a href='2007/04/index.html'>April 2007</a></li>
	<li><a href='2007/03/index.html'>March 2007</a></li>
	<li><a href='2007/02/index.html'>February 2007</a></li>
	<li><a href='2007/01/index.html'>January 2007</a></li>
	<li><a href='2006/12/index.html'>December 2006</a></li>
	<li><a href='2006/11/index.html'>November 2006</a></li>
	<li><a href='2006/10/index.html'>October 2006</a></li>
	<li><a href='2006/09/index.html'>September 2006</a></li>
	<li><a href='2006/08/index.html'>August 2006</a></li>
	<li><a href='2006/07/index.html'>July 2006</a></li>
	<li><a href='2006/06/index.html'>June 2006</a></li>
	<li><a href='2006/05/index.html'>May 2006</a></li>
	<li><a href='2006/04/index.html'>April 2006</a></li>
	<li><a href='2006/03/index.html'>March 2006</a></li>
	<li><a href='2006/02/index.html'>February 2006</a></li>
	<li><a href='2006/01/index.html'>January 2006</a></li>
				</ul>
			</li>

			<li id="meta" class="widget-container">
				<h3 class="widget-title">Meta</h3>
				<ul>
										<li><a href="#">Log in</a></li>
									</ul>
			</li>

					</ul>
		</div><!-- #primary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="site-info">
				<a href="/blawg/index.html" title="Dread Pirate PJ&#8217;s House of Hacks and Tricks" rel="home">
					Dread Pirate PJ&#8217;s House of Hacks and Tricks				</a>
			</div><!-- #site-info -->

			<div id="site-generator">
								<a href="https://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress.</a>
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->

</body>
</html>
